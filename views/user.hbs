<div class="row">

    <!--左側列 -->
    <div class="col">
        {{> left-nav}}
    </div>


    <!--中間列 -->

    <div class="col-7 border-start border-end px-0">
        <div class="d-flex">
            <a href="javascript:history.back()" style="color: #000000; text-decoration: none;">
                <i class="fas fa-arrow-left" style="font-size: 2em;"></i>
            </a>
            <div class="row m-2">
                <h5>{{user.name}}</h5>
                <small>{{tweetsCount}}推文</small>
            </div>
        </div>
        <div class="card" style="height: 250px;">
            <img src="{{user.cover}}" class="card-img-top" alt="cover" style="height:100%;width:100%; object-fit:cover">
        </div>
        <div class="d-flex justify-content-between mx-0 px-0">
            <img src="{{user.avatar}}" class="rounded-circle" style="width:80px;height:80px;">
            <div>
                {{#ifCond user.id currentUser.id}}
                <button type="button" class="btn border-0 text-light rounded-pill" style="background-color: #FF6600;"
                    data-bs-toggle="modal" data-bs-target="#exampleModal">
                    編輯個人資料
                </button>
                {{/ifCond}}
            </div>
        </div>
        <div class="row">
            <h5>{{user.name}}</h5>
            <small>@{{user.name}}</small>
            <p>{{user.introduction}}</p>
            <P>{{followingsCount}}個跟隨中 {{followersCount}}位跟隨者 </P>

        </div>
        <!-- Button trigger modal -->

        <hr class="mt-1" style="border: 10px solid rgb(106, 106, 106);" />
        <ul class="nav nav-tabs my-4">
            <li class="nav-item">
                <a class="nav-link {{#if user.Tweets}}active{{/if}}" href="/users/{{user.id}}/tweets">推文</a>
            </li>
            <li class="nav-item">
                <a class="nav-link {{#if userReplies}}active{{/if}}" href="/users/{{user.id}}/replies">回覆</a>
            </li>
            <li class="nav-item">
                <a class="nav-link {{#if user.Likes}}active{{/if}}" href="/users/{{user.id}}/likes">喜歡的內容</a>
            </li>
        </ul>
        <div style="overflow:auto;max-height:650px">
            {{#each tweets}}
            <div class="row mx-0 px-0">
                <div class="col-1">
                    <img src="{{../user.avatar}}" class="rounded-circle" style="width:50px;height:50px">
                </div>
                <div class="col">
                    <p>
                        <span>{{../user.name}}</span>
                        <span>@{{../user.account}} ‧ </span>
                        <span>{{relativeTimeFromNow this.updatedAt}}</span>
                    </p>
                    <p>{{this.description}}</p>
                    <p>
                        <i class="far fa-comment"></i> {{this.totalReply}}
                        {{#if this.isLiked}}
                        <i class="fas fa-heart text-danger"></i> {{this.totalLike}}
                        {{else}}
                        <i class="far fa-heart"></i> {{this.totalLike}}
                        {{/if}}
                    </p>
                </div>
            </div>
            <hr />
            {{/each}}

            {{#if likes}}
            {{#each likes}}
            <div class="row mx-0 px-0">
                <div class="col-1">
                    <img src="{{../user.avatar}}" class="rounded-circle" style="width:50px;height:50px">
                </div>
                <div class="col">
                    <p>
                        <span>{{this.Tweet.User.name}}</span>
                        <span>@{{this.Tweet.User.account}} ‧ </span>
                        <span>{{relativeTimeFromNow this.updatedAt}}</span>
                    </p>
                    <p>{{this.Tweet.description}}</p>
                    <p>
                        <i class="far fa-comment"></i> {{this.totalReply}}
                        {{#if this.isLiked}}
                        <i class="fas fa-heart text-danger"></i> {{this.totalLike}}
                        {{else}}
                        <i class="far fa-heart"></i> {{this.totalLike}}
                        {{/if}}
                    </p>
                </div>
            </div>
            <hr />
            {{/each}}
            {{/if}}

            {{#if user.Replies}}
            {{#each user.Replies}}
            <div class="row mx-0 px-0">
                <div class="col-1">
                    <img src="{{../user.avatar}}" class="rounded-circle" style="width:50px;height:50px">
                </div>
                <div class="col">
                    <p>
                        <span>{{../user.name}}</span>
                        <span>@{{../user.account}} ‧ </span>
                        <span>{{relativeTimeFromNow this.updatedAt}}</span>
                    </p>
                    <p>回覆@{{this.Tweet.User.account}}</p>
                    <p>{{this.Tweet.description}}</p>

                </div>
            </div>
            <hr />
            {{/each}}

            {{/if}}

        </div>
    </div>
    <!--右側列 -->
    <div class="col">{{> right-nav}}</div>
</div>


<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="/users/{{user.id}}/edit?_method=PUT" method="POST" enctype="multipart/form-data">


                <div class="modal-header">
                    <div class="d-flex justify-content-between">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        <h5 class="modal-title">編輯個人資料</h5>
                    </div>
                    <button type="submit" class="btn border-0 text-light rounded-pill"
                        style="background-color: #FF6600;">儲存</button>
                </div>
                <div class="modal-body row" style="position: relative;">
                    <div class="form-row mb-3">
                        <label class="btn cover-uploader" for="cover"
                            style="position: absolute; top: 110px; left:240px;">
                            <i class="fa-solid fa-camera" style="font-size: 2em;"></i>
                            <input class="d-none" type="file" id="cover" name="cover">
                        </label>
                        <img src="{{user.cover}}" alt="cover" style="height: 240px; width:470px;">
                    </div>
                    <div class="form-row mb-3" style="position: relative;">
                        <label class="btn avatar-uploader" for="avatar"
                            style="position: absolute; top: 7px; left: 27px;">
                            <i class="fa-solid fa-camera" style="font-size: 2em;"></i>
                            <input class="d-none" type="file" id="avatar" name="avatar">
                        </label>
                        <div class="col-1">
                            <img src="{{user.avatar}}" alt="avatar"
                                style="height: 80px; width: 80px; border-radius: 50%">
                        </div>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="name" placeholder="Name" name="name"
                            value="{{user.name}}">
                        <label for="floatingInput">名稱</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="introduction" class="form-control" id="introduction" placeholder="introduction"
                            name="introduction">
                        <label for="floatingIntroduction">自我介紹</label>
                    </div>
                </div>

            </form>


        </div>
    </div>
</div>